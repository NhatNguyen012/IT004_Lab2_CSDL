--Tuan 1--
-------------------------------- QuanLyBanHang --------------------------------------------
-- 1.	Tạo các quan hệ và khai báo các khóa chính, khóa ngoại của quan hệ.
CREATE DATABASE QuanLyBanHang;
GO
USE QuanLyBanHang;
GO
-------------------------------- KHACHHANG --------------------------------------------
CREATE TABLE KHACHHANG(
MAKH CHAR(4) PRIMARY KEY,
HOTEN VARCHAR(40),
DCHI VARCHAR(50),
SODT VARCHAR(20),
NGSINH SMALLDATETIME,
NGDK SMALLDATETIME,
DOANHSO MONEY,
)
GO
-------------------------------- NHANVIEN --------------------------------------------
CREATE TABLE NHANVIEN(
MANV CHAR(4) PRIMARY KEY,
HOTEN VARCHAR(40),
DTHOAI VARCHAR(20),
NGVL SMALLDATETIME,
)
GO
-------------------------------- SANPHAM --------------------------------------------
CREATE TABLE SANPHAM(
MASP CHAR(4) PRIMARY KEY,
TENSP VARCHAR(40),
DVT VARCHAR(20),
NUOCSX VARCHAR(40),
GIA MONEY,
)
GO
-------------------------------- HOADON --------------------------------------------
CREATE TABLE HOADON(
SOHD INT PRIMARY KEY,
NGHD SMALLDATETIME,
MAKH CHAR(4),
CONSTRAINT FK_MAKH FOREIGN KEY (MAKH) REFERENCES KHACHHANG(MAKH),
MANV CHAR(4),
CONSTRAINT FK_MANV FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV),
TRIGIA MONEY,
)
GO
-------------------------------- CTHD --------------------------------------------
CREATE TABLE CTHD(
SOHD INT,
MASP CHAR(4),
CONSTRAINT PK_CTHD PRIMARY KEY (SOHD, MASP),
CONSTRAINT FK_MASP FOREIGN KEY (MASP) REFERENCES SANPHAM (MASP),
CONSTRAINT FK_SOHD FOREIGN KEY (SOHD) REFERENCES HOADON (SOHD),
SL INT,
)
GO
-- 2.	Thêm vào thuộc tính GHICHU có kiểu dữ liệu varchar(20) cho quan hệ SANPHAM.
ALTER TABLE SANPHAM ADD GHICHU VARCHAR(20);
GO
-- 3.	Thêm vào thuộc tính LOAIKH có kiểu dữ liệu là tinyint cho quan hệ KHACHHANG.
ALTER TABLE KHACHHANG ADD LOAIKH TINYINT;
GO
-- 4.	Sửa kiểu dữ liệu của thuộc tính GHICHU trong quan hệ SANPHAM thành varchar(100).
ALTER TABLE SANPHAM
ALTER COLUMN GHICHU VARCHAR(100);
GO
-- 5.	Xóa thuộc tính GHICHU trong quan hệ SANPHAM.
ALTER TABLE SANPHAM DROP COLUMN GHICHU;
GO
-- 6.	Làm thế nào để thuộc tính LOAIKH trong quan hệ KHACHHANG có thể lưu các giá trị là: “Vang lai”, “Thuong xuyen”, “Vip”, …
ALTER TABLE KHACHHANG ALTER COLUMN LOAIKH VARCHAR(50);
ALTER TABLE KHACHHANG ADD CONSTRAINT CK_LOAIKH CHECK(LOAIKH in ('Vang lai', 'Thuong Xuyen', 'Vip'));
GO
-- 7.	Đơn vị tính của sản phẩm chỉ có thể là (“cay”,”hop”,”cai”,”quyen”,”chuc”)
ALTER TABLE SANPHAM ADD CONSTRAINT CK_DVT CHECK(DVT in ('cay', 'hop', 'cai', 'quyen', 'chuc'));
GO
-- 8.	Giá bán của sản phẩm từ 500 đồng trở lên.
ALTER TABLE SANPHAM ADD CONSTRAINT CK_GIA CHECK(GIA >= 500);
GO
-- 9.	Mỗi lần mua hàng, khách hàng phải mua ít nhất 1 sản phẩm.
ALTER TABLE CTHD ADD CONSTRAINT CK_SL CHECK(SL >= 1)
GO
-- 10.	Ngày khách hàng đăng ký là khách hàng thành viên phải lớn hơn ngày sinh của người đó.
ALTER TABLE KHACHHANG ADD CONSTRAINT CK_NGDK CHECK(NGDK > NGSINH)
GO

----------------------------------- QuanLiHocVu ----------------------------------------------
-- 1.	Tạo quan hệ và khai báo tất cả các ràng buộc khóa chính, khóa ngoại. Thêm vào 3 thuộc tính GHICHU, DIEMTB, XEPLOAI cho quan hệ HOCVIEN.
CREATE DATABASE QuanLiHocVu
GO
USE QuanLiHocVu
GO
----------------------------------- KHOA ----------------------------------------------
CREATE TABLE KHOA (
	MAKHOA VARCHAR(4) PRIMARY KEY,
	TENKHOA VARCHAR(40),
	NGTLAP SMALLDATETIME,
	TRGKHOA CHAR(4),
)
GO

---------------------------------- MONHOC ---------------------------------------------
CREATE TABLE MONHOC (
	MAMH VARCHAR(10) PRIMARY KEY,
	TENMH VARCHAR(40),
	TCLT TINYINT,
	TCTH TINYINT,
	MAKHOA VARCHAR(4) FOREIGN KEY REFERENCES KHOA(MAKHOA)
)
GO

--------------------------------- DIEUKIEN --------------------------------------------
CREATE TABLE DIEUKIEN
(
	MAMH VARCHAR(10) FOREIGN KEY REFERENCES MONHOC(MAMH),
	MAMH_TRUOC VARCHAR(10),
	PRIMARY KEY (MAMH, MAMH_TRUOC)
)
GO

--------------------------------- GIAOVIEN --------------------------------------------
CREATE TABLE GIAOVIEN
(
	MAGV CHAR(4) PRIMARY KEY,
	HOTEN VARCHAR(40),
	HOCVI VARCHAR(10),
	HOCHAM VARCHAR(10),
	GIOITINH VARCHAR(3),
	NGSINH SMALLDATETIME,
	NGVL SMALLDATETIME,
	HESO NUMERIC(4,2),
	MUCLUONG MONEY,
	MAKHOA VARCHAR(4) FOREIGN KEY REFERENCES KHOA(MAKHOA)
)
GO

----------------------------------- LOP -----------------------------------------------
CREATE TABLE LOP
(
	MALOP CHAR(3) PRIMARY KEY,
	TENLOP VARCHAR(40),
	TRGLOP CHAR(5),
	SISO TINYINT,
	MAGVCN CHAR(4) FOREIGN KEY REFERENCES GIAOVIEN(MAGV)
)
GO

--------------------------------- HOCVIEN ---------------------------------------------
CREATE TABLE HOCVIEN
(
	MAHV CHAR(5) PRIMARY KEY,
	HO VARCHAR(40),
	TEN VARCHAR(10),
	NGSINH SMALLDATETIME,
	GIOITINH VARCHAR(3),
	NOISINH VARCHAR(40),
	MALOP CHAR(3) FOREIGN KEY REFERENCES LOP(MALOP) 
)
GO

--------------------------------- GIANGDAY --------------------------------------------
CREATE TABLE GIANGDAY
(
	MALOP CHAR(3) FOREIGN KEY REFERENCES LOP(MALOP),
	MAMH VARCHAR(10) FOREIGN KEY REFERENCES MONHOC(MAMH),
	MAGV CHAR(4) FOREIGN KEY REFERENCES GIAOVIEN(MAGV),
	HOCKY TINYINT,
	NAM SMALLINT,
	TUNGAY SMALLDATETIME,
	DENNGAY SMALLDATETIME,
	PRIMARY KEY (MALOP, MAMH)
)
GO

--------------------------------- KETQUATHI -------------------------------------------
CREATE TABLE KETQUATHI
(
	MAHV CHAR(5) FOREIGN KEY REFERENCES HOCVIEN(MAHV),
	MAMH VARCHAR(10) FOREIGN KEY REFERENCES MONHOC(MAMH),
	LANTHI TINYINT,
	NGTHI SMALLDATETIME,
	DIEM NUMERIC(4,2),
	KQUA VARCHAR(10),
	PRIMARY KEY (MAHV, MAMH, LANTHI)
)
GO

ALTER TABLE KHOA ADD CONSTRAINT FK__KHOA__TRGKHOA FOREIGN KEY (TRGKHOA) REFERENCES GIAOVIEN(MAGV)
GO

ALTER TABLE HOCVIEN ADD GHICHU VARCHAR(60)
GO

ALTER TABLE HOCVIEN ADD DIEMTB NUMERIC(4, 2)
GO 

ALTER TABLE HOCVIEN ADD XEPLOAI VARCHAR(10)
GO

-- 3.	Thuộc tính GIOITINH chỉ có giá trị là “Nam” hoặc “Nu”.
ALTER TABLE HOCVIEN ADD CONSTRAINT CK_GIOITINH CHECK(GIOITINH IN ('Nam', 'Nu'))
GO

-- 4.	Điểm số của một lần thi có giá trị từ 0 đến 10 và cần lưu đến 2 số lẽ (VD: 6.22).
ALTER TABLE KETQUATHI
ADD CONSTRAINT CK_DIEM CHECK (
    DIEM BETWEEN 0 AND 10  -- Do thuộc tính DIEM đang có kiểu dữ liệu NUMERIC(4,2) nên chỉ cần kiểm tra điều kiện của phần nguyên
);
GO

-- 5.	Kết quả thi là “Dat” nếu điểm từ 5 đến 10  và “Khong dat” nếu điểm nhỏ hơn 5.
ALTER TABLE KETQUATHI ADD CONSTRAINT CK_KQUA CHECK(KQUA = IIF(DIEM BETWEEN 5 AND 10, 'Dat', 'Khong dat'))
GO

-- 6.	Học viên thi một môn tối đa 3 lần.
ALTER TABLE KETQUATHI ADD CONSTRAINT CK_SOLANTHI CHECK(LANTHI <= 3)
GO

-- 7.	Học kỳ chỉ có giá trị từ 1 đến 3.
ALTER TABLE GIANGDAY ADD CONSTRAINT CK_HOCKY CHECK(HOCKY BETWEEN 1 AND 3)
GO

-- 8.	Học vị của giáo viên chỉ có thể là “CN”, “KS”, “Ths”, ”TS”, ”PTS”.
ALTER TABLE GIAOVIEN ADD CONSTRAINT CK_HOCVI CHECK(HOCVI IN ('CN', 'KS', 'Ths', 'TS', 'PTS'))
GO



--Tuan 2--
--II. Ngôn ngữ thao tác dữ liệu (Data Manipulation Language)
--Bài tập 1: Sinh viên tiến hành viết câu lệnh nhập dữ liệu cho CSDL QuanLyBanHang

--NHAP DATA VAO TABLE NHANVIEN
INSERT INTO NHANVIEN (MANV, HOTEN, DTHOAI, NGVL)
VALUES 
('NV01', N'Nguyen Nhu Nhut', '0927345678', '2006/04/13'),
('NV02', N'Le Thi Phi Yen', '0987567390', '2006/04/21'),
('NV03', N'Nguyen Van B', '0997047382', '2006/04/27'),
('NV04', N'Ngo Thanh Tuan', '0913758498', '2006/06/24'),
('NV05', N'Nguyen Thi Truc Thanh', '0918590387', '2006/07/20');
GO
--NHAP DATA VAO TABLE KHACHHANG
INSERT INTO KHACHHANG (MAKH, HOTEN, DCHI, SODT, NGSINH, DOANHSO, NGDK)
VALUES 
('KH01', N'Nguyen Van A', '731 Tran Hung Dao, Q5, TpHCM', '08823451', '1960-10-22', 13060000, '2006-07-22'),
('KH02', N'Tran Ngoc Han', '23/5 Nguyen Trai, Q5, TpHCM', '0908256478', '1974-04-03', 280000, '2006-07-30'),
('KH03', N'Tran Ngoc Linh', '45 Nguyen Canh Chan, Q1, TpHCM', '0938776266', '1980-06-12', 3860000, '2006-08-05'),
('KH04', N'Tran Minh Long', '50/34 Le Dai Hanh, Q10, TpHCM', '0917325476', '1965-03-09', 250000, '2006-10-02'),
('KH05', N'Le Nhat Minh', '34 Truong Dinh, Q3, TpHCM', '08246108', '1950-03-10', 21000, '2006-10-28'),
('KH06', N'Le Hoai Thuong', '227 Nguyen Van Cu, Q5, TpHCM', '08631738', '1981-12-31', 915000, '2006-11-24'),
('KH07', N'Nguyen Van Tam', '32/3 Tran Binh Trong, Q5, TpHCM', '0916783565', '1971-04-06', 12500, '2006-12-01'),
('KH08', N'Phan Thi Thanh', '45/2 An Duong Vuong, Q5, TpHCM', '0938435756', '1971-01-10', 365000, '2006-12-13'),
('KH09', N'Le Ha Vinh', '873 Le Hong Phong, Q5, TpHCM', '08654763', '1979-09-03', 70000, '2007-01-14'),
('KH10', N'Ha Duy Lap', '34/34B Nguyen Trai, Q1, TpHCM', '08768904', '1983-05-02', 67500, '2007-01-16');
GO
--NHAP DATA VAO TABLE SANPHAM
INSERT INTO SANPHAM (MASP, TENSP, DVT, NUOCSX, GIA)
VALUES 
('BC01', N'But chi', N'cay', N'Singapore', 3000),
('BC02', N'But chi', N'cay', N'Singapore', 5000),
('BC03', N'But chi', N'cay', N'Viet Nam', 3500),
('BC04', N'But chi', N'hop', N'Viet Nam', 30000),
('BB01', N'But bi', N'cay', N'Viet Nam', 5000),
('BB02', N'But bi', N'cay', N'Trung Quoc', 7000),
('BB03', N'But bi', N'hop', N'Thai Lan', 100000),
('TV01', N'Tap 100 giay mong', N'quyen', N'Trung Quoc', 2500),
('TV02', N'Tap 200 giay mong', N'quyen', N'Trung Quoc', 4500),
('TV03', N'Tap 100 giay tot', N'quyen', N'Viet Nam', 3000),
('TV04', N'Tap 200 giay tot', N'quyen', N'Viet Nam', 5500),
('TV05', N'Tap 100 trang', N'chuc', N'Viet Nam', 23000),
('TV06', N'Tap 200 trang', N'chuc', N'Viet Nam', 53000),
('TV07', N'Tap 100 trang', N'chuc', N'Trung Quoc', 34000),
('ST01', N'So tay 500 trang', N'quyen', N'Trung Quoc', 40000),
('ST02', N'So tay loai 1', N'quyen', N'Viet Nam', 55000),
('ST03', N'So tay loai 2', N'quyen', N'Viet Nam', 51000),
('ST04', N'So tay', N'quyen', N'Thai Lan', 55000),
('ST05', N'So tay mong', N'quyen', N'Thai Lan', 20000),
('ST06', N'Phan viet bang', N'hop', N'Viet Nam', 5000),
('ST07', N'Phan khong bui', N'hop', N'Viet Nam', 7000),
('ST08', N'Bong bang', N'cai', N'Viet Nam', 1000),
('ST09', N'But long', N'cay', N'Viet Nam', 5000),
('ST10', N'But long', N'cay', N'Trung Quoc', 7000);
GO
--NHAP DATA VAO TABLE HOADON
INSERT INTO HOADON (SOHD, NGHD, MAKH, MANV, TRIGIA)
VALUES 
(1001, '2006-07-23', 'KH01', 'NV01', 320000),
(1002, '2006-08-12', 'KH01', 'NV02', 840000),
(1003, '2006-08-23', 'KH02', 'NV01', 100000),
(1004, '2006-09-01', 'KH02', 'NV01', 180000),
(1005, '2006-10-20', 'KH01', 'NV02', 3800000),
(1006, '2006-10-16', 'KH01', 'NV03', 2430000),
(1007, '2006-10-28', 'KH03', 'NV03', 510000),
(1008, '2006-10-28', 'KH01', 'NV03', 440000),
(1009, '2006-10-28', 'KH03', 'NV04', 200000),
(1010, '2006-11-01', 'KH01', 'NV01', 5200000),
(1011, '2006-11-04', 'KH04', 'NV03', 250000),
(1012, '2006-11-30', 'KH05', 'NV03', 21000),
(1013, '2006-12-12', 'KH06', 'NV01', 5000),
(1014, '2006-12-31', 'KH03', 'NV02', 3150000),
(1015, '2007-01-01', 'KH06', 'NV01', 910000),
(1016, '2007-01-01', 'KH07', 'NV02', 12500),
(1017, '2007-01-02', 'KH08', 'NV03', 35000),
(1018, '2007-01-13', 'KH08', 'NV03', 330000),
(1019, '2007-01-13', 'KH01', 'NV03', 30000),
(1020, '2007-01-14', 'KH09', 'NV04', 70000),
(1021, '2007-01-16', 'KH10', 'NV03', 67500),
(1022, '2007-01-16', NULL, 'NV03', 7000),
(1023, '2007-01-17', NULL, 'NV01', 330000);
GO
--NHAP DATA VAO TABLE CTHD
INSERT INTO CTHD (SOHD, MASP, SL)
VALUES 
(1001, 'TV02', 10),
(1001, 'ST01', 5),
(1001, 'BC01', 5),
(1001, 'BC02', 10),
(1001, 'ST08', 10),
(1002, 'BC04', 20),
(1002, 'BB01', 20),
(1002, 'BB02', 20),
(1003, 'BB03', 10),
(1004, 'TV01', 20),
(1004, 'TV02', 10),
(1004, 'TV03', 10),
(1004, 'TV04', 10),
(1005, 'TV05', 50),
(1005, 'TV06', 50),
(1006, 'TV07', 20),
(1006, 'ST01', 30),
(1006, 'ST02', 10),
(1007, 'ST03', 10),
(1008, 'ST04', 8),
(1009, 'ST05', 10),
(1010, 'TV07', 50),
(1010, 'ST07', 50),
(1010, 'ST08', 100),
(1010, 'ST04', 50),
(1010, 'TV03', 100),
(1011, 'ST06', 50),
(1012, 'ST07', 3),
(1013, 'ST08', 5),
(1014, 'BC02', 80),
(1014, 'BB02', 100),
(1014, 'BC04', 60),
(1014, 'BB01', 50),
(1015, 'BB02', 30),
(1015, 'BB03', 7),
(1016, 'TV01', 5),
(1017, 'TV02', 1),
(1017, 'TV03', 1),
(1017, 'TV04', 5),
(1018, 'ST04', 6),
(1019, 'ST05', 1),
(1019, 'ST06', 2),
(1020, 'ST07', 10),
(1021, 'ST08', 5),
(1021, 'TV01', 7),
(1021, 'TV02', 10),
(1022, 'ST07', 1),
(1023, 'ST04', 6);
GO

--Bài tập 2: Sinh viên tiến hành viết câu lệnh nhập dữ liệu cho CSDL QuanLyGiaoVu.
--XOA KHOA NGOAI TRUOC KHI INSERT DATA 
ALTER TABLE GIAOVIEN 
DROP CONSTRAINT FK__GIAOVIEN__MAKHOA__5165187F
GO

ALTER TABLE GIANGDAY 
DROP CONSTRAINT FK__GIANGDAY__MAGV__5BE2A6F2, FK__GIANGDAY__MAMH__5AEE82B9, FK__GIANGDAY__MALOP__59FA5E80
GO

ALTER TABLE KHOA 
DROP CONSTRAINT FK__KHOA__TRGKHOA
GO

ALTER TABLE MONHOC
DROP CONSTRAINT FK__MONHOC__MAKHOA__4BAC3F29
GO

ALTER TABLE DIEUKIEN
DROP CONSTRAINT FK__DIEUKIEN__MAMH__4E88ABD4
GO

ALTER TABLE LOP
DROP CONSTRAINT FK__LOP__MAGVCN__5441852A
GO

ALTER TABLE HOCVIEN
DROP CONSTRAINT FK__HOCVIEN__MALOP__571DF1D5
GO

ALTER TABLE KETQUATHI
DROP CONSTRAINT FK__KETQUATHI__MAHV__5EBF139D, FK__KETQUATHI__MAMH__5FB337D6
GO

--NHAP DATA CHO TABLE KHOA
INSERT INTO KHOA VALUES ('KHMT','Khoa hoc may tinh','7/6/2005','GV01')
INSERT INTO KHOA VALUES ('HTTT','He thong thong tin','7/6/2005','GV02')
INSERT INTO KHOA VALUES ('CNPM','Cong nghe phan mem','7/6/2005','GV04')
INSERT INTO KHOA VALUES ('MTT','Mang va truyen thong','2005-10-20','GV03') 
INSERT INTO KHOA VALUES ('KTMT','Ky thuat may tinh','2005-12-20',Null)
GO

--NHAP DATA CHO TABLE GIAOVIEN
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) 
VALUES 
('GV01', N'Ho Thanh Son', 'PTS', 'GS', 'Nam', '1950-05-02', '2004-01-11', 5.00, 2250000, 'KHMT'),
('GV02', N'Tran Tam Thanh', 'TS', 'PGS', 'Nam', '1965-12-17', '2004-04-20', 4.50, 2025000, 'HTTT'),
('GV03', N'Do Nghiem Phung', 'TS', 'GS', 'Nu', '1950-08-01', '2004-09-23', 4.00, 1800000, 'CNPM'),
('GV04', N'Tran Nam Son', 'TS', 'PGS', 'Nam', '1961-02-22', '2005-01-12', 4.50, 2025000, 'KTMT'),
('GV05', N'Mai Thanh Danh', 'ThS', 'GV', 'Nam', '1958-03-12', '2005-01-12', 3.00, 1350000, 'HTTT'),
('GV06', N'Tran Doan Hung', 'TS', 'GV', 'Nam', '1953-03-11', '2005-01-12', 4.50, 2025000, 'KHMT'),
('GV07', N'Nguyen Minh Tien', 'ThS', 'GV', 'Nam', '1971-11-23', '2005-03-01', 4.00, 1800000, 'KHMT'),
('GV08', N'Le Thi Tran', 'KS', NULL, 'Nu', '1974-03-26', '2005-03-01', 1.69, 760500, 'KHMT'),
('GV09', N'Nguyen To Lan', 'ThS', 'GV', 'Nu', '1966-12-31', '2005-03-01', 4.00, 1800000, 'HTTT'),
('GV10', N'Le Tran Anh Loan', 'KS', NULL, 'Nu', '1972-07-17', '2005-03-01', 1.86, 837000, 'CNPM'),
('GV11', N'Ho Thanh Tung', 'CN', 'GV', 'Nam', '1980-01-12', '2005-05-15', 2.67, 1201500, 'MTT'),
('GV12', N'Tran Van Anh', 'CN', NULL, 'Nu', '1981-03-29', '2005-05-15', 1.69, 760500, 'CNPM'),
('GV13', N'Nguyen Linh Dan', 'CN', NULL, 'Nu', '1980-05-23', '2005-05-15', 1.69, 760500, 'KTMT'),
('GV14', N'Truong Minh Chau', 'ThS', 'GV', 'Nu', '1976-11-30', '2005-05-15', 3.00, 1350000, 'MTT'),
('GV15', N'Le Ha Thanh', 'ThS', 'GV', 'Nam', '1978-05-04', '2005-05-15', 3.00, 1350000, 'KHMT');
GO

--NHAP DATA CHO TABLE LOP
INSERT INTO LOP VALUES ('K11','Lop 1 khoa 1','K1108',11,'GV07')
INSERT INTO LOP VALUES ('K12','Lop 2 khoa 1','K1205',12,'GV09')
INSERT INTO LOP VALUES ('K13','Lop 3 khoa 1','K1305',12,'GV14')
GO

--NHAP DATA CHO TABLE MONHOC
INSERT INTO MONHOC VALUES ('THDC','Tin hoc dai cuong',4,1,'KHMT')
INSERT INTO MONHOC VALUES ('CTRR','Cau truc roi rac',5,2,'KHMT')
INSERT INTO MONHOC VALUES ('CSDL','Co so du lieu',3,1,'HTTT')
INSERT INTO MONHOC VALUES ('CTDLGT','Cau truc du lieu va giai thuat',3,1,'KHMT')
INSERT INTO MONHOC VALUES ('PTTKTT','Phan tich thiet ke thuat toan',3,0,'KHMT')
INSERT INTO MONHOC VALUES ('DHMT','Do hoa may tinh',3,1,'KHMT')
INSERT INTO MONHOC VALUES ('KTMT','Kien truc may tinh',3,0,'KTMT')
INSERT INTO MONHOC VALUES ('TKCSDL','Thiet ke co so du lieu',3,1,'HTTT')
INSERT INTO MONHOC VALUES ('PTTKHTTT','Phan tich thiet ke he thong thong tin',4,1,'HTTT')
INSERT INTO MONHOC VALUES ('HDH','He dieu hanh',4,1,'KTMT')
INSERT INTO MONHOC VALUES ('NMCNPM','Nhap mon cong nghe phan mem',3,0,'CNPM')
INSERT INTO MONHOC VALUES ('LTCFW','Lap trinh C for win',3,1,'CNPM')
INSERT INTO MONHOC VALUES ('LTHDT','Lap trinh huong doi tuong',3,1,'CNPM')
GO

--NHAP DATA CHO TABLE GIANGDAY
INSERT INTO GIANGDAY VALUES ('K11','THDC','GV07',1,2006,'2006-01-02','2006-05-12');
INSERT INTO GIANGDAY VALUES ('K12','THDC','GV06',1,2006,'2006-01-02','2006-05-12');
INSERT INTO GIANGDAY VALUES ('K13','THDC','GV15',1,2006,'2006-01-02','2006-05-12');
INSERT INTO GIANGDAY VALUES ('K11','CTRR','GV02',1,2006,'2006-01-09','2006-05-17');
INSERT INTO GIANGDAY VALUES ('K12','CTRR','GV02',1,2006,'2006-01-09','2006-05-17');
INSERT INTO GIANGDAY VALUES ('K13','CTRR','GV08',1,2006,'2006-01-09','2006-05-17');
INSERT INTO GIANGDAY VALUES ('K11','CSDL','GV05',2,2006,'2006-06-01','2006-07-15');
INSERT INTO GIANGDAY VALUES ('K12','CSDL','GV09',2,2006,'2006-06-01','2006-07-15');
INSERT INTO GIANGDAY VALUES ('K13','CTDLGT','GV15',2,2006,'2006-06-01','2006-07-15');
INSERT INTO GIANGDAY VALUES ('K13','CSDL','GV05',3,2006,'2006-08-01','2006-12-15');
INSERT INTO GIANGDAY VALUES ('K13','DHMT','GV07',3,2006,'2006-08-01','2006-12-15');
INSERT INTO GIANGDAY VALUES ('K11','CTDLGT','GV15',3,2006,'2006-08-01','2006-12-15');
INSERT INTO GIANGDAY VALUES ('K12','CTDLGT','GV15',3,2006,'2006-08-01','2006-12-15');
INSERT INTO GIANGDAY VALUES ('K11','HDH','GV04',1,2007,'2007-01-02','2007-02-18');
INSERT INTO GIANGDAY VALUES ('K12','HDH','GV04',1,2007,'2007-01-02','2007-03-20');
INSERT INTO GIANGDAY VALUES ('K11','DHMT','GV07',1,2007,'2007-02-18','2007-03-20');
GO

--NHAP DATA CHO TABLE DIEUKIEN
INSERT INTO DIEUKIEN VALUES ('CSDL','CTRR')
INSERT INTO DIEUKIEN VALUES ('CSDL','CTDLGT')
INSERT INTO DIEUKIEN VALUES ('CTDLGT','THDC')
INSERT INTO DIEUKIEN VALUES ('PTTKTT','THDC')
INSERT INTO DIEUKIEN VALUES ('PTTKTT','CTDLGT')
INSERT INTO DIEUKIEN VALUES ('DHMT','THDC')
INSERT INTO DIEUKIEN VALUES ('LTHDT','THDC')
INSERT INTO DIEUKIEN VALUES ('PTTKHTTT','CSDL')
GO

--NHAP DATA CHO TABLE KETQUATHI
INSERT INTO KETQUATHI VALUES ('K1101','CSDL',1,'2006-07-20',10.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1101','CTDLGT',1,'2006-12-28',9.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1101','THDC',1,'2006-05-20',9.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1101','CTRR',1,'2006-05-13',9.50,'Dat');
INSERT INTO KETQUATHI VALUES ('K1102','CSDL',1,'2006-07-20',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1102','CSDL',2,'2006-07-27',4.25,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1102','CSDL',3,'2006-08-10',4.50,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1102','CTDLGT',1,'2006-12-28',4.50,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1102','CTDLGT',2,'2007-01-05',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1102','CTDLGT',3,'2007-01-15',6.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1102','THDC',1,'2006-05-20',5.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1102','CTRR',1,'2006-05-13',7.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1103','CSDL',1,'2006-07-20',3.50,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1103','CSDL',2,'2006-07-27',8.25,'Dat');
INSERT INTO KETQUATHI VALUES ('K1103','CTDLGT',1,'2006-12-28',7.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1103','THDC',1,'2006-05-20',8.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1103','CTRR',1,'2006-05-13',6.50,'Dat');
INSERT INTO KETQUATHI VALUES ('K1104','CSDL',1,'2006-07-20',3.75,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1104','CTDLGT',1,'2006-12-28',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1104','THDC',1,'2006-05-20',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1104','CTRR',1,'2006-05-13',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1104','CTRR',2,'2006-05-20',3.50,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1104','CTRR',3,'2006-06-30',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1201','CSDL',1,'2006-07-20',6.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1201','CTDLGT',1,'2006-12-28',5.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1201','THDC',1,'2006-05-20',8.50,'Dat');
INSERT INTO KETQUATHI VALUES ('K1201','CTRR',1,'2006-05-13',9.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1202','CSDL',1,'2006-07-20',8.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1202','CTDLGT',1,'2006-12-28',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1202','CTDLGT',2,'2007-01-05',5.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1202','THDC',1,'2006-05-20',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1202','THDC',2,'2006-05-27',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1202','CTRR',1,'2006-05-13',3.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1202','CTRR',2,'2006-05-20',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1202','CTRR',3,'2006-06-30',6.25,'Dat');
INSERT INTO KETQUATHI VALUES ('K1203','CSDL',1,'2006-07-20',9.25,'Dat');
INSERT INTO KETQUATHI VALUES ('K1203','CTDLGT',1,'2006-12-28',9.50,'Dat');
INSERT INTO KETQUATHI VALUES ('K1203','THDC',1,'2006-05-20',10.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1203','CTRR',1,'2006-05-13',10.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1204','CSDL',1,'2006-07-20',8.50,'Dat');
INSERT INTO KETQUATHI VALUES ('K1204','CTDLGT',1,'2006-12-28',6.75,'Dat');
INSERT INTO KETQUATHI VALUES ('K1204','THDC',1,'2006-05-20',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1204','CTRR',1,'2006-05-13',6.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1301','CSDL',1,'2006-12-20',4.25,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1301','CTDLGT',1,'2006-07-25',8.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1301','THDC',1,'2006-05-20',7.75,'Dat');
INSERT INTO KETQUATHI VALUES ('K1301','CTRR',1,'2006-05-13',8.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1302','CSDL',1,'2006-12-20',6.75,'Dat');
INSERT INTO KETQUATHI VALUES ('K1302','CTDLGT',1,'2006-07-25',5.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1302','THDC',1,'2006-05-20',8.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1302','CTRR',1,'2006-05-13',8.50,'Dat');
INSERT INTO KETQUATHI VALUES ('K1303','CSDL',1,'2006-12-20',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303','CTDLGT',1,'2006-07-25',4.50,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303','CTDLGT',2,'2006-08-07',4.00,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303','CTDLGT',3,'2006-08-15',4.25,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303','THDC',1,'2006-05-20',4.50,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303','CTRR',1,'2006-05-13',3.25,'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303','CTRR',2,'2006-05-20',5.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1304','CSDL',1,'2006-12-20',7.75,'Dat');
INSERT INTO KETQUATHI VALUES ('K1304','CTDLGT',1,'2006-07-25',9.75,'Dat');
INSERT INTO KETQUATHI VALUES ('K1304','THDC',1,'2006-05-20',5.50,'Dat');
INSERT INTO KETQUATHI VALUES ('K1304','CTRR',1,'2006-05-13',5.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1305','CSDL',1,'2006-12-20',9.25,'Dat');
INSERT INTO KETQUATHI VALUES ('K1305','CTDLGT',1,'2006-07-25',10.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1305','THDC',1,'2006-05-20',8.00,'Dat');
INSERT INTO KETQUATHI VALUES ('K1305','CTRR',1,'2006-05-13',10.00,'Dat');
GO

--NHAP DATA CHO TABLE HOCVIEN
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1101', 'Nguyen Van', 'A', '1986-01-27', 'Nam', 'TpHCM', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1102', 'Tran Ngoc', 'Han', '1986-03-14', 'Nu', 'Kien Giang', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1103', 'Ha Duy', 'Lap', '1986-04-18', 'Nam', 'Nghe An', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1104', 'Tran Ngoc', 'Linh', '1986-03-30', 'Nu', 'Tay Ninh', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1105', 'Tran Minh', 'Long', '1986-02-27', 'Nam', 'TpHCM', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1106', 'Le Nhat', 'Minh', '1986-01-24', 'Nam', 'TpHCM', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1107', 'Nguyen Nhu', 'Nhut', '1986-01-27', 'Nam', 'Ha Noi', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1108', 'Nguyen Manh', 'Tam', '1986-02-27', 'Nam', 'Kien Giang', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1109', 'Phan Thi Thanh', 'Tam', '1986-01-27', 'Nu', 'Vinh Long', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1110', 'Le Hoai', 'Thuong', '1986-02-05', 'Nu', 'Can Tho', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1111', 'Le Ha', 'Vinh', '1986-12-25', 'Nam', 'Vinh Long', 'K11');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1201', 'Nguyen Van', 'B', '1986-02-11', 'Nam', 'TpHCM', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1202', 'Nguyen Thi Kim', 'Duyen', '1986-01-18', 'Nu', 'TpHCM', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1203', 'Tran Thi Kim', 'Duyen', '1986-09-17', 'Nu', 'TpHCM', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1204', 'Truong My', 'Hanh', '1986-05-19', 'Nu', 'Dong Nai', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1205', 'Nguyen Thanh', 'Nam', '1986-04-17', 'Nam', 'TpHCM', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1206', 'Nguyen Thi Truc', 'Thanh', '1986-03-04', 'Nu', 'Kien Giang', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1207', 'Tran Thi Bich', 'Thuy', '1986-02-08', 'Nu', 'Nghe An', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1208', 'Huynh Thi Kim', 'Trieu', '1986-04-08', 'Nu', 'Tay Ninh', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1209', 'Pham Thanh', 'Trieu', '1986-02-23', 'Nam', 'TpHCM', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1210', 'Ngo Thanh', 'Tuan', '1986-02-14', 'Nam', 'TpHCM', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1211', 'Do Thi', 'Xuan', '1986-03-09', 'Nu', 'Ha Noi', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1212', 'Le Thi Phi', 'Yen', '1986-03-12', 'Nu', 'TpHCM', 'K12');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1301', 'Nguyen Thi Kim', 'Cuc', '1986-06-09', 'Nu', 'Kien Giang', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1302', 'Truong Thi My', 'Hien', '1986-03-18', 'Nu', 'Nghe An', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1303', 'Le Duc', 'Hien', '1986-03-21', 'Nam', 'Tay Ninh', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1304', 'Le Quang', 'Hien', '1986-04-18', 'Nam', 'TpHCM', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1305', 'Le Thi', 'Huong', '1986-03-27', 'Nu', 'TpHCM', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1306', 'Nguyen Thai', 'Huu', '1986-03-30', 'Nam', 'Ha Noi', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1307', 'Tran Minh', 'Man', '1986-05-28', 'Nam', 'TpHCM', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1308', 'Nguyen Hieu', 'Nghia', '1986-04-08', 'Nam', 'Kien Giang', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1309', 'Nguyen Trung', 'Nghia', '1987-01-18', 'Nam', 'Nghe An', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1310', 'Tran Thi Hong', 'Tham', '1986-04-22', 'Nu', 'Tay Ninh', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1311', 'Tran Minh', 'Thuc', '1986-04-04', 'Nam', 'TpHCM', 'K13');
INSERT INTO HOCVIEN(MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1312', 'Nguyen Thi Kim', 'Yen', '1986-09-07', 'Nu', 'TpHCM', 'K13');
GO
-- Foreign key in MONHOC table
ALTER TABLE MONHOC
ADD CONSTRAINT FK_MONHOC_MAKHOA FOREIGN KEY (MAKHOA) 
REFERENCES KHOA (MAKHOA);
GO
-- Foreign key in DIEUKIEN table
ALTER TABLE DIEUKIEN
ADD CONSTRAINT FK_DIEUKIEN_MAMH FOREIGN KEY (MAMH)
REFERENCES MONHOC (MAMH);
GO
-- Foreign key in GIAOVIEN table
ALTER TABLE GIAOVIEN
ADD CONSTRAINT FK_GIAOVIEN_MAKHOA FOREIGN KEY (MAKHOA) 
REFERENCES KHOA (MAKHOA);
GO
-- Foreign key in LOP table
ALTER TABLE LOP
ADD CONSTRAINT FK_LOP_MAGVCN FOREIGN KEY (MAGVCN)
REFERENCES GIAOVIEN (MAGV);
GO
-- Foreign key HOCVIEN
ALTER TABLE HOCVIEN
ADD CONSTRAINT FK_HOCVIEN_MALOP FOREIGN KEY (MALOP) 
REFERENCES LOP (MALOP);
GO
-- Foreign key GIANGDAY_LOP
ALTER TABLE GIANGDAY
ADD CONSTRAINT FK_GIANGDAY_MALOP FOREIGN KEY (MALOP)
REFERENCES LOP (MALOP);
GO
-- Foreign key GIANGDAY_MONHOC
ALTER TABLE GIANGDAY
ADD CONSTRAINT FK_GIANGDAY_MAMH FOREIGN KEY (MAMH)
REFERENCES MONHOC (MAMH);
GO
-- Foreign key GIANGDAY_GIAOVIEN
ALTER TABLE GIANGDAY
ADD CONSTRAINT FK_GIANGDAY_MAGV FOREIGN KEY (MAGV)
REFERENCES GIAOVIEN (MAGV);
GO
-- Foreign key KETQUATHI_HOCVIEN
ALTER TABLE KETQUATHI
ADD CONSTRAINT FK_KETQUATHI_MAHV FOREIGN KEY (MAHV)
REFERENCES HOCVIEN (MAHV);
GO
-- Foreign key KETQUATHI_MONHOC
ALTER TABLE KETQUATHI
ADD CONSTRAINT FK_KETQUATHI_MAMH FOREIGN KEY (MAMH)
REFERENCES MONHOC (MAMH);
GO
-- Foreign key TRGKHOA_KHOA
ALTER TABLE KHOA
ADD CONSTRAINT FK_KHOA_TRGKHOA FOREIGN KEY (TRGKHOA) 
REFERENCES GIAOVIEN (MAGV);
GO

--Bài tập 3: Sinh viên hoàn thành Phần II bài tập QuanLyBanHang từ câu 2 đến câu 5.
-- 2. Tạo quan hệ SANPHAM1 chứa toàn bộ dữ liệu của quan hệ SANPHAM. Tạo quan hệ KHACHHANG1 chứa toàn bộ dữ liệu của quan hệ KHACHHANG.
SELECT * INTO SANPHAM1 FROM SANPHAM;
GO
SELECT * INTO KHACHHANG1 FROM KHACHHANG;
GO

-- 3. Cập nhật giá tăng 5% đối với những sản phẩm do “Thai Lan” sản xuất (cho quan hệ SANPHAM1)
UPDATE SANPHAM1 SET GIA = GIA * 1.05 
WHERE NUOCSX = 'Thai Lan';
GO

-- 4. Cập nhật giá giảm 5% đối với những sản phẩm do “Trung Quoc” sản xuất có giá từ 10.000 trở xuống (cho quan hệ SANPHAM1).
UPDATE SANPHAM1 SET GIA = GIA * 0.95 WHERE NUOCSX = 'Trung Quoc' AND GIA <= 10000;
GO

-- 5. Cập nhật giá trị LOAIKH là “Vip” đối với những khách hàng đăng ký thành viên trước ngày 1/1/2007 có doanh số từ 10.000.000 trở lên hoặc khách hàng đăng ký thành viên từ 1/1/2007 trở về
-- sau có doanh số từ 2.000.000 trở lên (cho quan hệ KHACHHANG1).
UPDATE KHACHHANG1 SET LOAIKH = 'Vip'
WHERE (NGDK < '2007/1/1' AND DOANHSO >= 10000000) OR (NGDK >= '2007/1/1' AND DOANHSO >= 2000000);
GO

--Bài tập 4: Sinh viên hoàn thành Phần I bài tập QuanLyGiaoVu từ câu 11 đến câu 14.
--11. Học viên ít nhất là 18 tuổi. 
ALTER TABLE HOCVIEN 
ADD CONSTRAINT CHK_TUOI_HV 
CHECK (YEAR(GETDATE())-YEAR(NGSINH) >= 18)
GO
--12. Giảng dạy một môn học ngày bắt đầu (TUNGAY) phải nhỏ hơn ngày kết thúc (DENNGAY). 
ALTER TABLE GIANGDAY 
ADD CONSTRAINT CHK_NGAY 
CHECK (TUNGAY < DENNGAY)
GO
--13. Giáo viên khi vào làm ít nhất là 22 tuổi.
ALTER TABLE GIAOVIEN
ADD CONSTRAINT CHK_GV_VAOLAM
CHECK (YEAR(NGVL) - YEAR(NGSINH) >= 22);
GO
--14. Tất cả các môn học đều có số tín chỉ lý thuyết và tín chỉ thực hành chênh lệch nhau không quá 3. 
ALTER TABLE MONHOC
ADD CONSTRAINT CHK_CHENHLECH_TINCHI
CHECK (ABS(TCLT - TCTH) <= 3);
GO
 
--Bài tập 5: Sinh viên hoàn thành Phần III bài tập QuanLyBanHang từ câu 1 đến câu 11. 
--III. Ngôn ngữ truy vấn dữ liệu có cấu trúc
--1. In ra danh sách các sản phẩm (MASP,TENSP) do “Trung Quoc” sản xuất.
SELECT MASP, TENSP
FROM SANPHAM
WHERE NUOCSX = 'Trung Quoc';
GO
--2. In ra danh sách các sản phẩm (MASP, TENSP) có đơn vị tính là “cay”, ”quyen”. 
SELECT MASP, TENSP
FROM SANPHAM
WHERE DVT = 'cay' OR DVT = 'quyen';
GO

--3. In ra danh sách các sản phẩm (MASP,TENSP) có mã sản phẩm bắt đầu là “B” và kết thúc là “01”. 
SELECT MASP, TENSP
FROM SANPHAM
WHERE MASP LIKE 'B%01';
GO
--4. In ra danh sách các sản phẩm (MASP,TENSP) do “Trung Quốc” sản xuất có giá từ 30.000 đến 40.000.
SELECT MASP, TENSP
FROM SANPHAM
WHERE NUOCSX = 'Trung Quoc' 
AND GIA BETWEEN 30000 AND 40000;
GO

--5. In ra danh sách các sản phẩm (MASP,TENSP) do “Trung Quoc” hoặc “Thai Lan” sản xuất có giá từ 30.000 đến 40.000.
SELECT MASP, TENSP
FROM SANPHAM
WHERE (NUOCSX = 'Trung Quoc' OR NUOCSX = 'Thai Lan') 
AND GIA BETWEEN 30000 AND 40000;
GO

--6. In ra các số hóa đơn, trị giá hóa đơn bán ra trong ngày 1/1/2007 và ngày 2/1/2007. 
SELECT SOHD , TRIGIA 
FROM HOADON
WHERE NGHD IN ('2007-01-01', '2007-01-02');
GO
--7. In ra các số hóa đơn, trị giá hóa đơn trong tháng 1/2007, sắp xếp theo ngày (tăng dần) và trị giá của hóa đơn (giảm dần). 
SELECT SOHD , TRIGIA 
FROM HOADON
WHERE NGHD >= '2007-01-01' AND NGHD < '2007-02-01'
ORDER BY NGHD ASC, TRIGIA DESC;
GO

--8. In ra danh sách các khách hàng (MAKH, HOTEN) đã mua hàng trong ngày 1/1/2007.
SELECT DISTINCT KH.MAKH, KH.HOTEN
FROM KHACHHANG KH
JOIN HOADON HD ON KH.MAKH = HD.MAKH
WHERE HD.NGHD = '2007-01-01';
GO
--9. In ra số hóa đơn, trị giá các hóa đơn do nhân viên có tên “Nguyen Van B” lập trong ngày 28/10/2006. 
SELECT HD.SOHD , HD.TRIGIA 
FROM HOADON HD
JOIN NHANVIEN NV ON HD.MANV = NV.MANV
WHERE NV.HOTEN = 'Nguyen Van B' AND HD.NGHD  = '2006-10-28';
GO
-- 10. In ra danh sách các sản phẩm (MASP,TENSP) được khách hàng có tên “Nguyen Van A” mua trong tháng 10/2006. 
SELECT SP.MASP, SP.TENSP
FROM HOADON HD
JOIN KHACHHANG KH ON HD.MAKH = KH.MAKH
JOIN CTHD CT ON HD.SOHD = CT.SOHD
JOIN SANPHAM SP ON CT.MASP = SP.MASP
WHERE KH.HOTEN = 'Nguyen Van A'
  AND HD.NGHD >= '2006-10-01'
  AND HD.NGHD < '2006-11-01';
GO
--11. Tìm các số hóa đơn đã mua sản phẩm có mã số “BB01” hoặc “BB02”. 
SELECT DISTINCT HD.SOHD
FROM HOADON HD
JOIN CTHD CT ON HD.SOHD = CT.SOHD
WHERE CT.MASP IN ('BB01', 'BB02');
GO

--Bài tập 6: Sinh viên hoàn thành Phần III bài tập QuanLyGiaoVu từ câu 1 đến câu 5. 
--III. Ngôn ngữ truy vấn dữ liệu: 
--1. In ra danh sách (mã học viên, họ tên, ngày sinh, mã lớp) lớp trưởng của các lớp.
SELECT HV.MAHV, HV.HO + ' ' + HV.TEN AS HOTEN, HV.NGSINH, L.MALOP
FROM HOCVIEN HV
JOIN LOP L ON HV.MALOP = L.MALOP
WHERE L.TRGLOP = HV.MAHV;
GO

--2. In ra bảng điểm khi thi (mã học viên, họ tên, lần thi, điểm số) môn CTRR của lớp “K12”, sắp xếp theo tên, họ học viên. 
SELECT HV.MAHV, HV.HO + ' ' + HV.TEN AS HOTEN, KT.LANTHI, KT.DIEM
FROM HOCVIEN HV
JOIN LOP L ON HV.MALOP = L.MALOP
JOIN KETQUATHI KT ON HV.MAHV = KT.MAHV
JOIN MONHOC MH ON KT.MAMH = MH.MAMH
WHERE L.MALOP = 'K12' AND MH.MAMH = 'CTRR'
ORDER BY HV.TEN, HV.HO;
GO

--3. In ra danh sách những học viên (mã học viên, họ tên) và những môn học mà học viên đó thi lần thứ nhất đã đạt. 
SELECT HV.MAHV, HV.HO + ' ' + HV.TEN AS HOVTEN, MH.TENMH
FROM HOCVIEN HV
JOIN KETQUATHI KT ON HV.MAHV = KT.MAHV
JOIN MONHOC MH ON KT.MAMH = MH.MAMH
WHERE KT.LANTHI = 1 AND KT.DIEM >= 5;
GO
--4. In ra danh sách học viên (mã học viên, họ tên) của lớp “K11” thi môn CTRR không đạt (ở lần thi 1). 
SELECT HV.MAHV, HV.HO + ' ' + HV.TEN AS HOVTEN
FROM HOCVIEN HV
JOIN LOP L ON HV.MALOP = L.MALOP
JOIN KETQUATHI KT ON HV.MAHV = KT.MAHV
JOIN MONHOC MH ON KT.MAMH = MH.MAMH
WHERE L.MALOP = 'K11' AND MH.MAMH = 'CTRR' AND KT.LANTHI = 1 AND KT.DIEM < 5;
GO
--5. * Danh sách học viên (mã học viên, họ tên) của lớp “K” thi môn CTRR không đạt (ở tất cả các lần thi). 
SELECT HV.MAHV, HV.HO + ' ' + HV.TEN AS HOTEN
FROM HOCVIEN HV
JOIN LOP L ON HV.MALOP = L.MALOP
JOIN KETQUATHI KT ON HV.MAHV = KT.MAHV
JOIN MONHOC MH ON KT.MAMH = MH.MAMH
WHERE L.MALOP LIKE 'K%' AND MH.MAMH = 'CTRR'
GROUP BY HV.MAHV, HV.HO, HV.TEN
HAVING MIN(KT.DIEM) < 5;
GO